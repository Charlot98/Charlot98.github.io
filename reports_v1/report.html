<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æŠ¥å‘Šä¹¦å†™ - ç½‘é¡µ3</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Microsoft YaHei', sans-serif;
            background: #f5f5f5;
            min-height: 100vh;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px 32px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header h1 {
            font-size: 24px;
            font-weight: 600;
        }

        .case-id {
            font-size: 18px;
            font-weight: 500;
        }

        .main-container {
            display: flex;
            height: calc(100vh - 80px);
        }

        .left-panel, .right-panel {
            padding: 24px;
            overflow-y: auto;
        }

        .left-panel {
            width: 50%;
            background: white;
            border-right: 2px solid #e0e0e0;
        }

        .right-panel {
            width: 50%;
            background: #f8f9fa;
        }

        .panel-title {
            font-size: 20px;
            font-weight: 600;
            color: #333;
            margin-bottom: 20px;
            padding-bottom: 12px;
            border-bottom: 2px solid #667eea;
        }

        .form-group {
            margin-bottom: 24px;
        }

        .form-group label {
            display: block;
            font-weight: 500;
            color: #495057;
            margin-bottom: 8px;
            font-size: 14px;
        }

        .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 14px;
            font-family: inherit;
            resize: vertical;
            min-height: 200px;
            line-height: 1.6;
        }

        .form-group textarea:focus {
            outline: none;
            border-color: #667eea;
        }

        .final-version {
            background: white;
            padding: 16px;
            border-radius: 8px;
            border: 2px solid #e0e0e0;
            margin-bottom: 16px;
        }

        .final-version h4 {
            color: #667eea;
            margin-bottom: 12px;
            font-size: 16px;
        }

        .final-content {
            line-height: 1.8;
            color: #333;
        }

        .final-content strong {
            font-weight: 600;
            background: #fff3cd;
            padding: 2px 4px;
        }

        .action-buttons {
            display: flex;
            gap: 12px;
            margin-top: 24px;
            padding-top: 24px;
            border-top: 2px solid #e0e0e0;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .btn-secondary:hover {
            background: #5a6268;
        }

        .info-section {
            background: white;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 16px;
        }

        .info-item {
            margin-bottom: 12px;
            padding-bottom: 12px;
            border-bottom: 1px solid #f0f0f0;
        }

        .info-item:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }

        .info-label {
            font-weight: 500;
            color: #6c757d;
            font-size: 13px;
            margin-bottom: 4px;
        }

        .info-value {
            color: #333;
            font-size: 14px;
        }

        .image-url {
            margin-bottom: 20px;
            padding: 16px;
            background: #e7f3ff;
            border-radius: 8px;
            border-left: 4px solid #2196F3;
        }

        .image-url a {
            color: #1976D2;
            text-decoration: none;
            word-break: break-all;
        }

        .image-url a:hover {
            text-decoration: underline;
        }

        .comparison-mode .right-panel {
            background: white;
        }

        .comparison-content {
            line-height: 1.8;
            color: #333;
        }

        .keyword-missed {
            background: #ffebee;
            color: #c62828;
            padding: 2px 4px;
            border-radius: 3px;
            font-weight: 500;
        }

        .keyword-correct {
            background: #e8f5e9;
            color: #2e7d32;
            padding: 2px 4px;
            border-radius: 3px;
            font-weight: 500;
        }

        .keyword-required {
            font-weight: 600;
            background: #fff3cd;
            padding: 2px 4px;
        }

        .toggle-mode {
            margin-bottom: 16px;
        }

        .toggle-btn {
            padding: 8px 16px;
            border: 2px solid #667eea;
            background: white;
            color: #667eea;
            border-radius: 6px;
            cursor: pointer;
            font-size: 13px;
        }

        .toggle-btn.active {
            background: #667eea;
            color: white;
        }

        .image-gallery {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 16px;
            margin-top: 12px;
        }

        .image-item {
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            overflow: hidden;
            background: white;
            transition: all 0.3s ease;
        }

        .image-item:hover {
            border-color: #667eea;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.2);
        }

        .image-item img {
            width: 100%;
            height: 150px;
            object-fit: cover;
            cursor: pointer;
            display: block;
        }

        .image-name {
            padding: 8px;
            font-size: 12px;
            color: #6c757d;
            text-align: center;
            word-break: break-all;
        }

        .image-modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            justify-content: center;
            align-items: center;
        }

        .image-modal.active {
            display: flex;
        }

        .image-modal-content {
            max-width: 90%;
            max-height: 90%;
            position: relative;
        }

        .image-modal-content img {
            max-width: 100%;
            max-height: 90vh;
            object-fit: contain;
        }

        .image-modal-close {
            position: absolute;
            top: 20px;
            right: 20px;
            color: white;
            font-size: 40px;
            font-weight: bold;
            cursor: pointer;
            background: rgba(0, 0, 0, 0.5);
            border-radius: 50%;
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            line-height: 1;
        }

        .image-modal-close:hover {
            background: rgba(0, 0, 0, 0.8);
        }

        .image-modal-title {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            color: white;
            background: rgba(0, 0, 0, 0.7);
            padding: 8px 16px;
            border-radius: 6px;
            font-size: 14px;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>ğŸ“ æŠ¥å‘Šä¹¦å†™</h1>
        <div class="case-id" id="caseIdDisplay"></div>
    </div>

    <div class="main-container" id="mainContainer">
        <div class="left-panel">
            <h2 class="panel-title">æŠ¥å‘Šè¾“å…¥</h2>
            
            <div class="form-group">
                <label>æ‰€è§</label>
                <textarea id="findings" placeholder="è¯·è¾“å…¥æ‰€è§å†…å®¹"></textarea>
            </div>

            <div class="form-group">
                <label>ç»“è®º</label>
                <textarea id="conclusion" placeholder="è¯·è¾“å…¥ç»“è®º"></textarea>
            </div>

            <div class="action-buttons">
                <button class="btn btn-secondary" onclick="saveDraft()">ğŸ’¾ æš‚å­˜</button>
                <button class="btn btn-primary" onclick="submitReport()">âœ… æäº¤</button>
                <a href="preview.html" class="btn btn-secondary">â† è¿”å›</a>
            </div>
        </div>

        <div class="right-panel" id="rightPanel">
            <!-- å†…å®¹å°†æ ¹æ®æ¨¡å¼åŠ¨æ€åˆ‡æ¢ -->
        </div>
    </div>

    <!-- å›¾ç‰‡æŸ¥çœ‹æ¨¡æ€æ¡† -->
    <div class="image-modal" id="imageModal" onclick="closeImageModal(event)">
        <div class="image-modal-content" onclick="event.stopPropagation()">
            <span class="image-modal-close" onclick="closeImageModal(event)">&times;</span>
            <img id="modalImage" src="" alt="">
            <div class="image-modal-title" id="modalImageTitle"></div>
        </div>
    </div>

    <script>
        let currentCase = null;
        let comparisonMode = false;

        // è·å–URLå‚æ•°
        function getUrlParameter(name) {
            const urlParams = new URLSearchParams(window.location.search);
            return urlParams.get(name);
        }

        // åŠ è½½ç—…ä¾‹æ•°æ®
        function loadCase() {
            const caseId = getUrlParameter('caseId');
            if (!caseId) {
                alert('æœªæŒ‡å®šç—…ä¾‹ID');
                window.location.href = 'preview.html';
                return;
            }

            const cases = JSON.parse(localStorage.getItem('cases') || '[]');
            currentCase = cases.find(c => c.caseId === caseId);

            if (!currentCase) {
                alert('ç—…ä¾‹ä¸å­˜åœ¨');
                window.location.href = 'preview.html';
                return;
            }

            // ç¡®ä¿æœ€ç»ˆæŠ¥å‘Šå­˜åœ¨ï¼ˆåº”è¯¥åœ¨ä¸Šä¼ æ—¶å·²è®¾ç½®ï¼‰
            if (!currentCase.finalReport) {
                currentCase.finalReport = {
                    findings: 'æœªè®¾ç½®æœ€ç»ˆæŠ¥å‘Šæ‰€è§',
                    conclusion: 'æœªè®¾ç½®æœ€ç»ˆæŠ¥å‘Šç»“è®º'
                };
            }

            // åŠ è½½ç”¨æˆ·è¾“å…¥çš„æ‰€è§å’Œç»“è®º
            if (currentCase.userReport) {
                document.getElementById('findings').value = currentCase.userReport.findings || '';
                document.getElementById('conclusion').value = currentCase.userReport.conclusion || '';
            }

            // æ˜¾ç¤ºç—…ä¾‹ID
            document.getElementById('caseIdDisplay').textContent = currentCase.caseId;

            // æ˜¾ç¤ºå³ä¾§é¢æ¿
            showInfoPanel();
        }

        // æ˜¾ç¤ºåŸºæœ¬ä¿¡æ¯é¢æ¿
        function showInfoPanel() {
            comparisonMode = false;
            const panel = document.getElementById('rightPanel');
            panel.innerHTML = `
                ${currentCase.userReport ? `
                    <div class="toggle-mode">
                        <button class="toggle-btn ${!comparisonMode ? 'active' : ''}" onclick="showInfoPanel();">åŸºæœ¬ä¿¡æ¯</button>
                        <button class="toggle-btn ${comparisonMode ? 'active' : ''}" onclick="showComparisonPanel();">å¯¹æ¯”æ¨¡å¼</button>
                    </div>
                ` : ''}
                <h2 class="panel-title">åŸºæœ¬ä¿¡æ¯</h2>
                
                <div class="image-url">
                    <div style="font-weight: 500; margin-bottom: 8px; color: #1976D2;">ğŸ“ ç—…ä¾‹å½±åƒä¸‹è½½URL</div>
                    <a href="${currentCase.imageUrl}" target="_blank">${currentCase.imageUrl}</a>
                </div>

                <div class="info-section">
                    <div class="info-item">
                        <div class="info-label">å§“å</div>
                        <div class="info-value">${currentCase.patientName}</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">å¹´é¾„</div>
                        <div class="info-value">${currentCase.age}${currentCase.ageUnit || 'å²'}</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">æ€§åˆ«</div>
                        <div class="info-value">${currentCase.gender}</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">ç—…å²</div>
                        <div class="info-value">${currentCase.medicalHistory}</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">ä¸»è¯‰</div>
                        <div class="info-value">${currentCase.chiefComplaint}</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">ç—…ä¾‹ç±»å‹</div>
                        <div class="info-value">${currentCase.caseType}</div>
                    </div>
                </div>

                ${currentCase.labCheckFiles && currentCase.labCheckFiles.length > 0 ? `
                    <div class="info-section">
                        <div class="info-label" style="margin-bottom: 12px;">å®éªŒå®¤æ£€æŸ¥</div>
                        <div class="image-gallery">
                            ${currentCase.labCheckFiles.map(file => {
                                // æ”¯æŒå¤šç§æ ¼å¼ï¼šæ–°æ ¼å¼ï¼ˆpath/urlï¼‰ã€Base64æ ¼å¼ï¼ˆdataï¼‰ã€æ—§æ ¼å¼ï¼ˆå­—ç¬¦ä¸²ï¼‰
                                let imageSrc = '';
                                let fileName = 'å›¾ç‰‡';
                                
                                if (typeof file === 'string') {
                                    // æ—§æ ¼å¼ï¼šåªæœ‰æ–‡ä»¶å
                                    fileName = file;
                                    imageSrc = `public/${file}`;
                                } else if (file.path) {
                                    // æ–°æ ¼å¼ï¼šæœ‰ path å­—æ®µ
                                    imageSrc = file.path;
                                    fileName = file.name || file.path.split('/').pop();
                                } else if (file.url) {
                                    // æ–°æ ¼å¼ï¼šæœ‰ url å­—æ®µ
                                    imageSrc = file.url;
                                    fileName = file.name || file.url.split('/').pop();
                                } else if (file.data) {
                                    // Base64 æ ¼å¼ï¼ˆå¤‡ç”¨æ–¹æ¡ˆï¼‰
                                    imageSrc = file.data;
                                    fileName = file.name || 'å›¾ç‰‡';
                                } else {
                                    fileName = file.name || 'å›¾ç‰‡';
                                }
                                
                                return `<div class="image-item">
                                    <img src="${imageSrc.replace(/'/g, "\\'")}" alt="${fileName.replace(/'/g, "\\'")}" onclick="openImageModal('${imageSrc.replace(/'/g, "\\'")}', '${fileName.replace(/'/g, "\\'")}')" onerror="this.parentElement.innerHTML='<div style=\\'height: 150px; display: flex; align-items: center; justify-content: center; background: #f0f0f0; color: #999;\\'>ğŸ“„ æ— æ³•åŠ è½½å›¾ç‰‡</div><div class=\\'image-name\\'>${fileName.replace(/'/g, "\\'")}</div>'">
                                    <div class="image-name">${fileName}</div>
                                </div>`;
                            }).join('')}
                        </div>
                    </div>
                ` : ''}

                ${currentCase.ultrasoundFiles && currentCase.ultrasoundFiles.length > 0 ? `
                    <div class="info-section">
                        <div class="info-label" style="margin-bottom: 12px;">Bè¶…æ£€æŸ¥</div>
                        <div class="image-gallery">
                            ${currentCase.ultrasoundFiles.map(file => {
                                // æ”¯æŒå¤šç§æ ¼å¼ï¼šæ–°æ ¼å¼ï¼ˆpath/urlï¼‰ã€Base64æ ¼å¼ï¼ˆdataï¼‰ã€æ—§æ ¼å¼ï¼ˆå­—ç¬¦ä¸²ï¼‰
                                let imageSrc = '';
                                let fileName = 'å›¾ç‰‡';
                                
                                if (typeof file === 'string') {
                                    fileName = file;
                                    imageSrc = `public/${file}`;
                                } else if (file.path) {
                                    imageSrc = file.path;
                                    fileName = file.name || file.path.split('/').pop();
                                } else if (file.url) {
                                    imageSrc = file.url;
                                    fileName = file.name || file.url.split('/').pop();
                                } else if (file.data) {
                                    imageSrc = file.data;
                                    fileName = file.name || 'å›¾ç‰‡';
                                } else {
                                    fileName = file.name || 'å›¾ç‰‡';
                                }
                                
                                return `<div class="image-item">
                                    <img src="${imageSrc.replace(/'/g, "\\'")}" alt="${fileName.replace(/'/g, "\\'")}" onclick="openImageModal('${imageSrc.replace(/'/g, "\\'")}', '${fileName.replace(/'/g, "\\'")}')" onerror="this.parentElement.innerHTML='<div style=\\'height: 150px; display: flex; align-items: center; justify-content: center; background: #f0f0f0; color: #999;\\'>ğŸ“„ æ— æ³•åŠ è½½å›¾ç‰‡</div><div class=\\'image-name\\'>${fileName.replace(/'/g, "\\'")}</div>'">
                                    <div class="image-name">${fileName}</div>
                                </div>`;
                            }).join('')}
                        </div>
                    </div>
                ` : ''}

                ${currentCase.xrayFiles && currentCase.xrayFiles.length > 0 ? `
                    <div class="info-section">
                        <div class="info-label" style="margin-bottom: 12px;">Xçº¿æ£€æŸ¥</div>
                        <div class="image-gallery">
                            ${currentCase.xrayFiles.map(file => {
                                // æ”¯æŒå¤šç§æ ¼å¼ï¼šæ–°æ ¼å¼ï¼ˆpath/urlï¼‰ã€Base64æ ¼å¼ï¼ˆdataï¼‰ã€æ—§æ ¼å¼ï¼ˆå­—ç¬¦ä¸²ï¼‰
                                let imageSrc = '';
                                let fileName = 'å›¾ç‰‡';
                                
                                if (typeof file === 'string') {
                                    fileName = file;
                                    imageSrc = `public/${file}`;
                                } else if (file.path) {
                                    imageSrc = file.path;
                                    fileName = file.name || file.path.split('/').pop();
                                } else if (file.url) {
                                    imageSrc = file.url;
                                    fileName = file.name || file.url.split('/').pop();
                                } else if (file.data) {
                                    imageSrc = file.data;
                                    fileName = file.name || 'å›¾ç‰‡';
                                } else {
                                    fileName = file.name || 'å›¾ç‰‡';
                                }
                                
                                return `<div class="image-item">
                                    <img src="${imageSrc.replace(/'/g, "\\'")}" alt="${fileName.replace(/'/g, "\\'")}" onclick="openImageModal('${imageSrc.replace(/'/g, "\\'")}', '${fileName.replace(/'/g, "\\'")}')" onerror="this.parentElement.innerHTML='<div style=\\'height: 150px; display: flex; align-items: center; justify-content: center; background: #f0f0f0; color: #999;\\'>ğŸ“„ æ— æ³•åŠ è½½å›¾ç‰‡</div><div class=\\'image-name\\'>${fileName.replace(/'/g, "\\'")}</div>'">
                                    <div class="image-name">${fileName}</div>
                                </div>`;
                            }).join('')}
                        </div>
                    </div>
                ` : ''}
            `;
        }

        // æ˜¾ç¤ºå¯¹æ¯”é¢æ¿
        function showComparisonPanel() {
            comparisonMode = true;
            const panel = document.getElementById('rightPanel');
            const userFindings = document.getElementById('findings').value;
            const userConclusion = document.getElementById('conclusion').value;
            const finalFindings = currentCase.finalReport.findings;
            const finalConclusion = currentCase.finalReport.conclusion;

            panel.innerHTML = `
                <div class="toggle-mode">
                    <button class="toggle-btn ${!comparisonMode ? 'active' : ''}" onclick="showInfoPanel();">åŸºæœ¬ä¿¡æ¯</button>
                    <button class="toggle-btn ${comparisonMode ? 'active' : ''}" onclick="showComparisonPanel();">å¯¹æ¯”æ¨¡å¼</button>
                </div>

                <h2 class="panel-title">æœ€ç»ˆæŠ¥å‘Šå¯¹æ¯”</h2>

                <div class="final-version">
                    <h4>æ‰€è§</h4>
                    <div class="comparison-content">${highlightKeywords(finalFindings, userFindings)}</div>
                </div>

                <div class="final-version">
                    <h4>ç»“è®º</h4>
                    <div class="comparison-content">${highlightKeywords(finalConclusion, userConclusion)}</div>
                </div>

                <div style="margin-top: 16px; padding: 12px; background: #f8f9fa; border-radius: 6px; font-size: 13px;">
                    <div style="margin-bottom: 8px;">ğŸ“Œ å›¾ä¾‹ï¼š</div>
                    <div style="margin-bottom: 4px;"><span class="keyword-correct">ç»¿è‰²</span> = å·²ç­”å¯¹çš„å…³é”®è¯</div>
                    <div style="margin-bottom: 4px;"><span class="keyword-missed">çº¢è‰²</span> = æœªç­”åˆ°çš„å…³é”®è¯</div>
                    <div><span class="keyword-required">é»„è‰²èƒŒæ™¯</span> = å¿…é¡»ç­”åˆ°çš„å…³é”®è¯</div>
                </div>
            `;

            comparisonMode = true;
        }

        // é«˜äº®å…³é”®è¯
        function highlightKeywords(finalText, userText) {
            // æå–æœ€ç»ˆæŠ¥å‘Šä¸­çš„å…³é”®è¯ï¼ˆè¢«<strong>æ ‡ç­¾åŒ…è£¹çš„å†…å®¹ï¼‰
            const keywordRegex = /<strong>(.*?)<\/strong>/g;
            const keywords = [];
            let match;
            while ((match = keywordRegex.exec(finalText)) !== null) {
                keywords.push(match[1].trim());
            }

            // æ›¿æ¢strongæ ‡ç­¾ä¸ºspan
            let result = finalText.replace(/<strong>(.*?)<\/strong>/g, (match, keyword) => {
                // æ£€æŸ¥ç”¨æˆ·æ–‡æœ¬ä¸­æ˜¯å¦åŒ…å«æ­¤å…³é”®è¯
                const userLower = userText.toLowerCase();
                const keywordLower = keyword.toLowerCase();
                
                if (userLower.includes(keywordLower)) {
                    // å·²ç­”å¯¹ï¼Œæ ‡ç»¿
                    return `<span class="keyword-correct keyword-required">${keyword}</span>`;
                } else {
                    // æœªç­”åˆ°ï¼Œæ ‡çº¢
                    return `<span class="keyword-missed keyword-required">${keyword}</span>`;
                }
            });

            return result;
        }

        // ä¿å­˜è‰ç¨¿
        function saveDraft() {
            if (!currentCase) return;

            currentCase.userReport = {
                findings: document.getElementById('findings').value,
                conclusion: document.getElementById('conclusion').value
            };

            // æ›´æ–°localStorage
            const cases = JSON.parse(localStorage.getItem('cases') || '[]');
            const index = cases.findIndex(c => c.caseId === currentCase.caseId);
            if (index !== -1) {
                cases[index] = currentCase;
                localStorage.setItem('cases', JSON.stringify(cases));
            }

            alert('å·²æš‚å­˜');
        }

        // æäº¤æŠ¥å‘Š
        function submitReport() {
            if (!currentCase) return;

            const findings = document.getElementById('findings').value.trim();
            const conclusion = document.getElementById('conclusion').value.trim();

            if (!findings || !conclusion) {
                alert('è¯·å¡«å†™æ‰€è§å’Œç»“è®º');
                return;
            }

            currentCase.userReport = {
                findings: findings,
                conclusion: conclusion
            };

            // æ›´æ–°localStorage
            const cases = JSON.parse(localStorage.getItem('cases') || '[]');
            const index = cases.findIndex(c => c.caseId === currentCase.caseId);
            if (index !== -1) {
                cases[index] = currentCase;
                localStorage.setItem('cases', JSON.stringify(cases));
            }

            // åˆ‡æ¢åˆ°å¯¹æ¯”æ¨¡å¼
            showComparisonPanel();
        }

        // æ‰“å¼€å›¾ç‰‡æ¨¡æ€æ¡†
        function openImageModal(imageSrc, fileName) {
            document.getElementById('modalImage').src = imageSrc;
            document.getElementById('modalImageTitle').textContent = fileName;
            document.getElementById('imageModal').classList.add('active');
        }

        // å…³é—­å›¾ç‰‡æ¨¡æ€æ¡†
        function closeImageModal(event) {
            if (event) {
                event.stopPropagation();
            }
            document.getElementById('imageModal').classList.remove('active');
        }

        // æŒ‰ESCé”®å…³é—­æ¨¡æ€æ¡†
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                closeImageModal();
            }
        });

        // é¡µé¢åŠ è½½æ—¶åŠ è½½ç—…ä¾‹
        window.addEventListener('DOMContentLoaded', loadCase);
    </script>
</body>
</html>

